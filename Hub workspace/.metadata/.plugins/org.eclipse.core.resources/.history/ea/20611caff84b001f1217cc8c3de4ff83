/*
 * control_task.h
 *
 *  Created on: Jul 25, 2024
 *      Author: hzaib
 */

#ifndef APPLICATION_CONTROL_TASK_H_
#define APPLICATION_CONTROL_TASK_H_


#include <ti/sysbios/BIOS.h>
#include <ti/sysbios/knl/Queue.h>
#include <ti/sysbios/knl/Semaphore.h>
#include <ti/sysbios/knl/Task.h>
#include "ti_154stack_config.h"
#include "Defines.h"



TYPEDEF_STRUCT_PACKED {
    uint16_t dev_shortAddr;  /*device short address to send messages on*/
    uint64_t dev_signature; /*unique signature of CC1314*/
    uint8_t isWatch;   /*true false*/
    uint8_t isDing;    /*true false*/
    uint8_t isManager; /*true false*/
    uint16_t structValid;
}control_task_devices_info;

extern control_task_devices_info control_task_runtime_info[CONFIG_MAX_DEVICES];
extern control_task_devices_info control_task_watch_info[CONFIG_MAX_DEVICES];
extern control_task_devices_info control_task_ding_info[CONFIG_MAX_DEVICES];
extern control_task_devices_info control_task_manager_info[CONFIG_MAX_DEVICES];




/* These paired devices will only receive messages from one another */
TYPEDEF_STRUCT_PACKED {
    uint64_t Watch_Devsignature;  /*Pairing using unique signature of CC1314*/
    uint64_t Ding_Devsignature;    /*Pairing using unique signature of CC1314*/
    uint64_t Manager_Devsignature; /*if this 0xFFFFFFFF, then every manager will receive
                                    the notification for paired devices */
   uint16_t structValid;
}control_task_devices_pairing;

extern control_task_devices_pairing control_task_devPairing[CONFIG_MAX_DEVICES*2];






typedef struct _control_task_joinedDev_mail
{
    uint16_t shortAddr;
}control_task_joinedDev_mail;



extern status control_task_mail_post_DevInfo(ApiMac_mcpsDataInd_t *pDataInd);
extern status control_task_mail_post_DevJoined(uint16_t shortAdr);
extern void control_taskInit();


#endif /* APPLICATION_CONTROL_TASK_H_ */
